<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Carte Vita</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2em;
      background: url('sfondo.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #111;
    }

    header {
      text-align: center;
      margin-bottom: 1em;
    }

    header img {
      height: 60px;
      cursor: pointer;
      transition: opacity 0.3s;
    }

    header img:hover {
      opacity: 0.8;
    }

    #toggleSidebar {
      position: fixed;
      top: 70px;
      right: 20px;
      font-size: 30px;
      background: none;
      border: none;
      cursor: pointer;
      z-index: 1001;
    }

    #sidebar {
      position: fixed;
      top: 60px;
      right: -300px;
      width: 280px;
      height: 100%;
      background: rgba(255,255,255,0.95);
      box-shadow: -2px 0 5px rgba(0,0,0,0.3);
      padding: 1em;
      transition: right 0.3s ease-in-out;
      z-index: 1000;
    }

    #sidebar.open {
      right: 0;
    }

    #sidebar select {
      width: 100%;
      padding: 0.5em;
      margin-bottom: 1em;
    }

    .card {
      display: inline-block;
      text-align: center;
      margin: 0.5em;
    }

    .card img {
      width: 160px;
      border-radius: 8px;
      transition: transform 0.2s;
      cursor: pointer;
    }

    .card img:hover {
      transform: scale(1.05);
    }

    .card button {
      margin-top: 5px;
    }
  </style>
</head>
<body>

  <header>
    <a href="home.html"><img src="logo.jpg" alt="Home"></a>
  </header>

  <button id="toggleSidebar">â‰¡</button>

  <div id="sidebar">
    <select id="filtroSet">
      <option value="">SET</option>
      <option value="BASE">BASE</option>
      <option value="ESPANSIONE1">ESPANSIONE1</option>
    </select>

    <select id="filtroPietra">
      <option value="">PIETRA</option>
      <option>AMBRA</option><option>RUBINO</option><option>ACCIAIO</option>
      <option>SMERALDO</option><option>AMETISTA</option><option>ZAFFIRO</option>
    </select>

    <select id="filtroRarita">
      <option value="">RARITÃ€</option>
      <option>COMUNE</option><option>NON COMUNE</option>
      <option>RARA</option><option>EPICA</option><option>PROMO</option>
    </select>

    <select id="filtroClassificazione">
      <option value="">CLASSIFICAZIONE</option>
      <option>ANIMALE</option><option>COLLEGA</option><option>GUIDA</option>
      <option>FRATELLANZA</option><option>PROTAGONISTA</option>
    </select>

    <select id="filtroTipo">
      <option value="">TIPO</option>
      <option>PERSONAGGIO</option><option>OGGETTO</option>
      <option>AZIONE</option><option>LUOGO</option><option>CANZONE</option>
    </select>

    <select id="filtroCosto">
      <option value="">COSTO</option>
      <option>1</option><option>2</option><option>3</option>
      <option>4</option><option>5</option><option>6</option>
      <option>7</option><option>8</option><option>9</option>
    </select>

    <button onclick="filtraCarte()">ðŸŽ¯ Applica Filtri</button>
  </div>

  <input type="text" id="search" placeholder="Cerca una carta...">

  <div id="cards"></div>

  <script>
    document.getElementById('toggleSidebar').onclick = () => {
      document.getElementById('sidebar').classList.toggle('open');
    };

    let tutteLeCarte = [];

    fetch('cards.json')
      .then(r => r.json())
      .then(data => {
        tutteLeCarte = data;
        mostraCarte(tutteLeCarte);
      });

    function mostraCarte(carte) {
      const container = document.getElementById('cards');
      container.innerHTML = '';
      carte.forEach(carta => {
        const div = document.createElement('div');
        div.className = 'card';

        const img = document.createElement('img');
        img.src = `img/${carta["N."]}.jpg`;
        img.alt = carta["NOME CARTA"];
        if ((carta["RARITA'"] || '').toUpperCase() === 'PROMO') {
          img.style.boxShadow = '0 0 15px 5px gold';
          img.style.border = '2px solid gold';
        }

        const btn = document.createElement('button');
        btn.textContent = '+';
        btn.onclick = () => alert("Aggiunta carta: " + carta["NOME CARTA"]);

        div.appendChild(img);
        div.appendChild(btn);
        container.appendChild(div);
      });
    }

    function filtraCarte() {
      const testo = document.getElementById('search').value.toLowerCase();
      const costo = document.getElementById('filtroCosto').value;
      const pietra = document.getElementById('filtroPietra').value.toLowerCase();
      const rarita = document.getElementById('filtroRarita').value.toLowerCase();
      const classi = document.getElementById('filtroClassificazione').value.toLowerCase();
      const tipo = document.getElementById('filtroTipo').value.toLowerCase();
      const set = document.getElementById('filtroSet').value.toLowerCase();

      const filtrate = tutteLeCarte.filter(c => {
        return (!testo || (c["NOME CARTA"] || '').toLowerCase().includes(testo)) &&
               (!costo || (c.COSTO + '') === costo) &&
               (!pietra || (c.PIETRA || '').toLowerCase().includes(pietra)) &&
               (!rarita || (c["RARITA'"] || '').toLowerCase().includes(rarita)) &&
               (!classi || (c.CLASSIFICAZIONE || '').toLowerCase().includes(classi)) &&
               (!tipo || (c.TIPO || '').toLowerCase().includes(tipo)) &&
               (!set || (c.SET || '').toLowerCase().includes(set));
      });

      mostraCarte(filtrate);
    }
  </script>
</body>
</html>
